

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Live examples &mdash; EpyNN 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> EpyNN
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="epynn.html">EpyNN Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="Template.html">Template layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="Embedding.html">Data Embedding (Input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dense.html">Fully Connected (Dense)</a></li>
<li class="toctree-l1"><a class="reference internal" href="RNN.html">Recurrent Neural Network (RNN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="LSTM.html">Long Short-Term Memory (LSTM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="GRU.html">Gated Recurrent Unit (GRU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Convolution.html">Convolutional Neural Network (CNN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dropout.html">Dropout</a></li>
<li class="toctree-l1"><a class="reference internal" href="Flatten.html">Flatten</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Examples and data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Details.html">Details</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EpyNN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Live examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="live-examples">
<h1>Live examples<a class="headerlink" href="#live-examples" title="Permalink to this headline">¶</a></h1>
<p>Live examples in <code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive</span></code> are directories each containing the required codes to run dummy and real world examples.</p>
<p>Examples are intended to introduce different input data types, processing schemes and appropriate architecture layers to build Neural Networks with EpyNN.</p>
<p>In the philosophy or EpyNN, example directories are specific templates with respect to the nature of input data. Thus, users can adapt relevant directories for their own situation, with minimal code modification.</p>
<div class="section" id="dummy">
<h2>Dummy<a class="headerlink" href="#dummy" title="Permalink to this headline">¶</a></h2>
<p>Dummy examples are intended to help in understanding processing schemes for input data of diverse natures.</p>
<p>During development or for educational purpose, these examples can also be used for debugging because dummy data are generated from models known <em>a priori</em>.</p>
<div class="section" id="boolean">
<h3>Boolean<a class="headerlink" href="#boolean" title="Permalink to this headline">¶</a></h3>
<p>Boolean data type is a form of data with only two possible values, namely <code class="docutils literal notranslate"><span class="pre">True</span></code> and <code class="docutils literal notranslate"><span class="pre">False</span></code> in most programming languages. In Python, these values evaluate to <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">0</span></code> behind the scene. Calculations using Boolean data are very quick and performance gain also arise from easier data and output processing compared to other data types.</p>
<p>Examples of real world topics well suited for the Boolean data type may include: molecular interactions, gene regulation, disease prediction and diagnosis, among others. See the <a class="reference internal" href="#disease"><span class="std std-ref">Disease</span></a> example in the next section.</p>
<p>The directory <code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/dummy_boolean</span></code> contains a dummy example of EpyNN workflow for binary classification tasks with Boolean input data.</p>
<p><em>Data preparation, structure and shape</em></p>
<details>
<summary style="cursor:pointer">Expand text details</summary>

<br><p>One <code class="docutils literal notranslate"><span class="pre">dataset</span></code> is a list of <code class="docutils literal notranslate"><span class="pre">N_SAMPLES</span></code> samples.</p>
<p>One <code class="docutils literal notranslate"><span class="pre">sample</span></code> is a list with <code class="docutils literal notranslate"><span class="pre">features</span></code> and associated <code class="docutils literal notranslate"><span class="pre">label</span></code>.</p>
<p>One <code class="docutils literal notranslate"><span class="pre">features</span></code> object is a list of Boolean data and <code class="docutils literal notranslate"><span class="pre">label</span></code> a one-hot encoded label.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">sets_prepare()</span></code> function, a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop iterates over <code class="docutils literal notranslate"><span class="pre">N_SAMPLES</span></code> to generate <code class="docutils literal notranslate"><span class="pre">features</span></code> list of <code class="docutils literal notranslate"><span class="pre">N_FEATURES</span></code> random Boolean elements.</p>
<p>If the arbitrary condition <code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">features.count(True)</span> <span class="pre">&gt;</span> <span class="pre">features.count(False)</span> <span class="pre">)</span></code> evaluates to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then <code class="docutils literal notranslate"><span class="pre">features</span></code> is associated with a positive label <code class="docutils literal notranslate"><span class="pre">p_label</span></code> in one <code class="docutils literal notranslate"><span class="pre">sample</span></code> object.</p>
<p>Conversely, if the opposite condition <code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">features.count(True)</span> <span class="pre">&lt;</span> <span class="pre">features.count(False)</span> <span class="pre">)</span></code> evaluates to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then <code class="docutils literal notranslate"><span class="pre">features</span></code> is associated with a negative label <code class="docutils literal notranslate"><span class="pre">n_label</span></code> in one <code class="docutils literal notranslate"><span class="pre">sample</span></code> object.</p>
<p>At the end of each iteration, <code class="docutils literal notranslate"><span class="pre">sample</span></code> is appended to the <code class="docutils literal notranslate"><span class="pre">dataset</span></code> list object.</p>
<p>When the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop completes, the <code class="docutils literal notranslate"><span class="pre">dsets</span></code> list object is returned from the <code class="docutils literal notranslate"><span class="pre">cio.dataset_to_dsets()</span></code> function which takes <code class="docutils literal notranslate"><span class="pre">dataset</span></code> as argument.</p>
<p>The list <code class="docutils literal notranslate"><span class="pre">dsets</span></code> contains training, testing and validation sets such as <code class="docutils literal notranslate"><span class="pre">[dtrain,dtest,dval]</span></code>.</p>
<p>Elements in <code class="docutils literal notranslate"><span class="pre">dsets</span></code> are <code class="docutils literal notranslate"><span class="pre">nnlibs.commons.models.dataSet</span></code> objects with <code class="docutils literal notranslate"><span class="pre">features</span></code> and <code class="docutils literal notranslate"><span class="pre">label</span></code> vectors assigned to <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> attributes, respectively.</p>
</details>

<br><details>
<summary style="cursor:pointer">Data and shapes</summary>

<br><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataSet</span><span class="o">.</span><span class="n">n</span>           <span class="n">dummy_bolean_dtrain</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">shape</span>    <span class="p">(</span><span class="mi">500</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>       <span class="mi">0</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>     <span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>  <span class="p">(</span><span class="mi">11</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="p">[</span> <span class="kc">True</span>  <span class="kc">True</span> <span class="kc">False</span>  <span class="kc">True</span> <span class="kc">False</span> <span class="kc">False</span> <span class="kc">False</span> <span class="kc">False</span>  <span class="kc">True</span>  <span class="kc">True</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span>      <span class="p">[</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span>     <span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>  <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>     <span class="p">(</span><span class="mi">500</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="mi">1</span>

<span class="n">dataSet</span><span class="o">.</span><span class="n">n</span>           <span class="n">dummy_bolean_dtest</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">shape</span>    <span class="p">(</span><span class="mi">250</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>       <span class="mi">0</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>     <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>  <span class="p">(</span><span class="mi">11</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="p">[</span> <span class="kc">True</span>  <span class="kc">True</span>  <span class="kc">True</span> <span class="kc">False</span> <span class="kc">False</span>  <span class="kc">True</span>  <span class="kc">True</span> <span class="kc">False</span>  <span class="kc">True</span> <span class="kc">False</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span>      <span class="p">[</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span>     <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>  <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>     <span class="p">(</span><span class="mi">250</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="mi">0</span>

<span class="n">dataSet</span><span class="o">.</span><span class="n">n</span>           <span class="n">dummy_bolean_dval</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">shape</span>    <span class="p">(</span><span class="mi">250</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>       <span class="mi">0</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>     <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>  <span class="p">(</span><span class="mi">11</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="p">[</span> <span class="kc">True</span> <span class="kc">False</span>  <span class="kc">True</span> <span class="kc">False</span>  <span class="kc">True</span>  <span class="kc">True</span>  <span class="kc">True</span>  <span class="kc">True</span>  <span class="kc">True</span>  <span class="kc">True</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1</span>      <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span>     <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>  <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>     <span class="p">(</span><span class="mi">250</span><span class="p">,)</span>
<span class="n">dataSet</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>        <span class="mi">0</span>
</pre></div>
</div>
</details>

<br><div class="admonition note">
<p class="admonition-title">Note</p>
<p>In real world problems, the relationship between <code class="docutils literal notranslate"><span class="pre">features</span></code> (X) and <code class="docutils literal notranslate"><span class="pre">label</span></code> (Y) is unknown <em>a priori</em>. In this dummy example, the relationship is known <em>a priori</em> and the Neural Network should converge to approximate the <code class="docutils literal notranslate"><span class="pre">model_dummy_boolean()</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">model_dummy_boolean</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">X</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Positive</span>

    <span class="k">elif</span> <span class="n">X</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">X</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Negative</span>

    <span class="k">return</span> <span class="n">Y</span>
</pre></div>
</div>
</div>
<p><em>Architecture layers, training and prediction</em></p>
<details>
<summary style="cursor:pointer">Imports and headers</summary>

<br><p>In the current example script template, the <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">VARIABLE</span></code> comment in the <code class="docutils literal notranslate"><span class="pre">IMPORTS</span></code> part relates to imports which depends on input data type and shape.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">HEADERS</span></code> part depends on user preferences and loads settings from the <code class="docutils literal notranslate"><span class="pre">settings.py</span></code> file in the working directory.</p>
<p>Details can be found the <a class="reference internal" href="workflows.html#workflows"><span class="std std-ref">Workflows</span></a> chapter under the <a class="reference internal" href="workflows.html#initialization"><span class="std std-ref">Initialization</span></a> section. See <a class="reference internal" href="workflows.html#imports"><span class="std std-ref">Full imports</span></a>, <a class="reference internal" href="workflows.html#headers"><span class="std std-ref">Headers</span></a> and <a class="reference internal" href="workflows.html#settings"><span class="std std-ref">Settings</span></a> for direct access.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># EpyNN/nnlive/dummy_boolean/train.py</span>
<span class="c1"># Standard library imports</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="c1"># Related third party imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># Local application/library specific imports</span>
<span class="kn">from</span> <span class="nn">nnlibs.initialize</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">nnlibs.meta.models</span> <span class="kn">import</span> <span class="n">EpyNN</span>
<span class="kn">from</span> <span class="nn">nnlibs.embedding.models</span> <span class="kn">import</span> <span class="n">Embedding</span>
<span class="kn">from</span> <span class="nn">nnlibs.dense.models</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">import</span> <span class="nn">nnlibs.commons.library</span> <span class="k">as</span> <span class="nn">cl</span>
<span class="kn">import</span> <span class="nn">nnlibs.commons.maths</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">prepare_dataset</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">settings</span> <span class="k">as</span> <span class="nn">se</span>




<span class="c1">################################## HEADERS ################################</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span>

<span class="n">cl</span><span class="o">.</span><span class="n">init_dir</span><span class="p">(</span><span class="n">se</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

</pre></div>
</div>
</details>

<br><p>Upon execution of the <code class="docutils literal notranslate"><span class="pre">IMPORTS</span></code> and <code class="docutils literal notranslate"><span class="pre">HEADERS</span></code> parts, data are returned from the <code class="docutils literal notranslate"><span class="pre">sp.sets_prepare()</span></code> function in the <code class="docutils literal notranslate"><span class="pre">DATASETS</span></code> part.</p>
<p>Given a number of samples <code class="docutils literal notranslate"><span class="pre">N_SAMPLES</span></code> and number of Boolean features <code class="docutils literal notranslate"><span class="pre">N_FEATURES</span></code> describing each sample, the features vector of the corresponding set in this example has shape <code class="docutils literal notranslate"><span class="pre">(N_SAMPLES,</span> <span class="pre">N_FEATURES)</span></code>.</p>
<p>Given EpyNN built-in layer architectures, this shape is suited to the <code class="docutils literal notranslate"><span class="pre">Dense</span></code> layer, often referred to as <em>Fully connected layer</em> (See :ref:Dense).</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">BUILD</span> <span class="pre">MODEL</span></code> part, the <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">(1)</span></code> comments denotes a first example of architectures built in the <code class="docutils literal notranslate"><span class="pre">layers</span></code> list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">################################## DATASETS ################################</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">prepare_dataset</span><span class="p">(</span><span class="n">se</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span> <span class="c1"># See &quot;Data preparation, structure and shape&quot;</span>
<span class="c1">#dataset = cl.read_dataset()</span>

<span class="c1">################################ BUILD MODEL ###############################</span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Embedding_Dense-2-Softmax&#39;</span> <span class="c1"># (1)</span>
<span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">Embedding</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">se</span><span class="o">.</span><span class="n">dataset</span><span class="p">),</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># Dense() same as Dense(nodes=2,activate=cm.softmax)</span>

<span class="c1">#name = &#39;Dense-2-Sigmoid&#39; # (2)</span>
<span class="c1">#layers = [Dense(nodes=2,activate=cm.sigmoid)]</span>

<span class="c1">#name = &#39;Dense-8-ReLU_Dense-2-Softmax&#39; # (3)</span>
<span class="c1">#layers = [Dense(8,activate=cm.relu),Dense(2)]</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">EpyNN</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="p">[</span><span class="n">se</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span> <span class="n">se</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">se</span><span class="o">.</span><span class="n">hPars</span><span class="p">],</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>


<span class="c1">################################ TRAIN MODEL ################################</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>


<span class="c1">################################# USE MODEL #################################</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">read_model</span><span class="p">()</span>

<span class="n">unlabeled_dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">prepare_unlabeled</span><span class="p">(</span><span class="n">N_SAMPLES</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">embedding_unlabeled</span><span class="p">(</span><span class="n">unlabeled_dataset</span><span class="p">)</span>
<span class="c1"># [[ True  True  True False  True False False False  True False  True]]</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># [[0.714 0.286]]</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># [0]</span>
</pre></div>
</div>
</div>
<div class="section" id="numerical">
<h3>Numerical<a class="headerlink" href="#numerical" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/to_be_done</span></code></p>
<p><em>Data preparation, structure and shape</em></p>
<p><em>Architecture layers, training and prediction</em></p>
</div>
<div class="section" id="strings">
<h3>Strings<a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/dummy_strings</span></code></p>
<p><em>Data preparation, structure and shape</em></p>
<p><em>Architecture layers, training and prediction</em></p>
</div>
<div class="section" id="time-series">
<h3>Time series<a class="headerlink" href="#time-series" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/dummy_time</span></code></p>
<p><em>Data preparation, structure and shape</em></p>
<p><em>Architecture layers, training and prediction</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#EpyNN/nnlive/dummy_time/train.py</span>
<span class="c1">################################## IMPORTS ################################</span>
<span class="c1"># Set default environment and settings</span>
<span class="kn">from</span> <span class="nn">nnlibs.initialize</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># EpyNN meta-model for neural networks</span>
<span class="kn">from</span> <span class="nn">nnlibs.meta.models</span> <span class="kn">import</span> <span class="n">EpyNN</span>
<span class="c1"># Embedding layer for input data</span>
<span class="kn">from</span> <span class="nn">nnlibs.embedding.models</span> <span class="kn">import</span> <span class="n">Embedding</span>
<span class="c1"># Import models specific to layer architectures</span>
<span class="kn">from</span> <span class="nn">nnlibs.flatten.models</span> <span class="kn">import</span> <span class="n">Flatten</span>
<span class="kn">from</span> <span class="nn">nnlibs.dense.models</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">nnlibs.lstm.models</span> <span class="kn">import</span> <span class="n">LSTM</span>
<span class="kn">from</span> <span class="nn">nnlibs.rnn.models</span> <span class="kn">import</span> <span class="n">RNN</span>
<span class="kn">from</span> <span class="nn">nnlibs.gru.models</span> <span class="kn">import</span> <span class="n">GRU</span>
<span class="c1"># Commons utils and maths</span>
<span class="kn">import</span> <span class="nn">nnlibs.commons.library</span> <span class="k">as</span> <span class="nn">cl</span>
<span class="kn">import</span> <span class="nn">nnlibs.commons.maths</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="c1"># Routines for dataset preparation</span>
<span class="kn">import</span> <span class="nn">prepare_dataset</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># Local EpyNN settings</span>
<span class="kn">import</span> <span class="nn">settings</span> <span class="k">as</span> <span class="nn">se</span>
<span class="c1"># Compute with NumPy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="c1">################################## HEADERS ################################</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">threshold</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="s1">&#39;warn&#39;</span><span class="p">)</span>

<span class="n">cm</span><span class="o">.</span><span class="n">global_seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">cl</span><span class="o">.</span><span class="n">init_dir</span><span class="p">(</span><span class="n">se</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
<span class="c1"># DOCS_HEADERS</span>
<span class="c1">################################## DATASETS ################################</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">prepare_dataset</span><span class="p">(</span><span class="n">se</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
<span class="c1">#dataset = cl.read_dataset()</span>


<span class="c1">################################ BUILD MODEL ###############################</span>
<span class="n">embedding</span> <span class="o">=</span> <span class="n">Embedding</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="n">se</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span><span class="n">encode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Embedding_Flatten_Dense_Dense-2-Softmax&#39;</span> <span class="c1"># (1)</span>
<span class="n">layers</span> <span class="o">=</span> <span class="p">[</span><span class="n">embedding</span><span class="p">,</span><span class="n">Flatten</span><span class="p">(),</span><span class="n">Dense</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="n">cm</span><span class="o">.</span><span class="n">relu</span><span class="p">),</span><span class="n">Dense</span><span class="p">()]</span>

<span class="c1"># name = &#39;LSTM-128-bin-Softmax&#39; # (2)</span>
<span class="c1"># layers = [embedding,LSTM(128,binary=True)]</span>

<span class="c1"># name = &#39;Embedding_LSTM-128_Flatten_Dense_Dense-2-Softmax&#39; # (3)</span>
<span class="c1"># layers = [embedding,LSTM(128),Flatten(),Dense(16,cm.relu),Dense()]</span>


<span class="n">model</span> <span class="o">=</span> <span class="n">EpyNN</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span><span class="n">settings</span><span class="o">=</span><span class="p">[</span><span class="n">se</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span><span class="n">se</span><span class="o">.</span><span class="n">config</span><span class="p">,</span><span class="n">se</span><span class="o">.</span><span class="n">hPars</span><span class="p">])</span>


<span class="c1">################################ TRAIN MODEL ################################</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>


<span class="c1">################################# USE MODEL #################################</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">cl</span><span class="o">.</span><span class="n">read_model</span><span class="p">()</span>

<span class="n">unlabeled_dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">prepare_unlabeled</span><span class="p">(</span><span class="n">N_SAMPLES</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">embedding_unlabeled</span><span class="p">(</span><span class="n">unlabeled_dataset</span><span class="p">,</span><span class="n">encode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1">#</span>

<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
<div class="section" id="images">
<h3>Images<a class="headerlink" href="#images" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/dummy_images</span></code></p>
<p><em>Data preparation, structure and shape</em></p>
<p><em>Architecture layers, training and prediction</em></p>
</div>
</div>
<div class="section" id="real">
<h2>Real<a class="headerlink" href="#real" title="Permalink to this headline">¶</a></h2>
<div class="section" id="disease">
<span id="id1"></span><h3>Disease<a class="headerlink" href="#disease" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/to_be_done</span></code></p>
<p><em>Data preparation, structure and shape</em></p>
<p><em>Architecture layers, training and prediction</em></p>
</div>
<div class="section" id="id2">
<h3>Numerical?<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/to_be_done</span></code></p>
<p><em>Data preparation, structure and shape</em></p>
<p><em>Architecture layers, training and prediction</em></p>
</div>
<div class="section" id="ptms">
<h3>PTMs<a class="headerlink" href="#ptms" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/ptm_prediction</span></code></p>
<p><em>Data preparation, structure and shape</em></p>
<p><em>Architecture layers, training and prediction</em></p>
</div>
<div class="section" id="music">
<h3>Music<a class="headerlink" href="#music" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/music_author</span></code></p>
<p><em>Data preparation, structure and shape</em></p>
<p><em>Architecture layers, training and prediction</em></p>
</div>
<div class="section" id="mnist">
<h3>MNIST<a class="headerlink" href="#mnist" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/mnist_database</span></code></p>
<p><em>Data preparation, structure and shape</em></p>
<p><em>Architecture layers, training and prediction</em></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Florian Malard and Stéphanie Olivier-Van Stichelen.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>