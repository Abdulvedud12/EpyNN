

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Dummy dataset &mdash; EpyNN 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MNIST Database" href="../captcha_mnist/prepare_dataset.html" />
    <link rel="prev" title="Music Authorship" href="../author_music/prepare_dataset.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> EpyNN
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../EpyNN_Model.html">Neural Network (Model)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Layer_Model.html">Architecture Layers (Model)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Data_Model.html">Dataset (Model)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Embedding.html">Data Embedding (Input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Dense.html">Fully Connected (Dense)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../RNN.html">Recurrent Neural Network (RNN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LSTM.html">Long Short-Term Memory (LSTM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GRU.html">Gated Recurrent Unit (GRU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Convolution.html">Convolutional Neural Network (CNN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Dropout.html">Dropout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Flatten.html">Flatten</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../examples.html">Examples and data</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../examples.html#boolean">Boolean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples.html#string">String</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples.html#numerical-series">Numerical (Series)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../examples.html#numerical-image">Numerical (Image)</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Dummy dataset</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#What-is-an-image?">What is an image?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Why-preparing-a-dummy-dataset-with-…-features?">Why preparing a dummy dataset with … features?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Prepare-a-set-of-image-sample-features-and-related-label">Prepare a set of image sample features and related label</a></li>
<li class="toctree-l4"><a class="reference internal" href="#What-comes-next?">What comes next?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../captcha_mnist/prepare_dataset.html">MNIST Database</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Details.html">Details</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EpyNN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../examples.html">Examples and data</a> &raquo;</li>
        
      <li>Dummy dataset</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/nnlive/dummy_image/prepare_dataset.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Dummy-dataset">
<h1>Dummy dataset<a class="headerlink" href="#Dummy-dataset" title="Permalink to this headline">¶</a></h1>
<p>Find this notebook at <code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/dummy_image/prepare_dataset.ipynb</span></code>. Regular python code at <code class="docutils literal notranslate"><span class="pre">EpyNN/nnlive/dummy_image/prepare_dataset.py</span></code>.</p>
<p>This notebook is the fourth of the series on preparing data for Neural Network regression with EpyNN.</p>
<p>In addition to the topic-specific content, it contains several explanations about basics or general concepts in programming that are important in the context.</p>
<p>Note that elements developed in dummy dataset <a class="reference internal" href="../dummy_boolean/prepare_dataset.html"><span class="doc">with Boolean</span></a>, <a class="reference internal" href="../dummy_string/prepare_dataset.html"><span class="doc">with string</span></a> and <a class="reference internal" href="../dummy_time/prepare_dataset.html"><span class="doc">with numerical (time-series)</span></a> features may not be recalled herein.</p>
<div class="section" id="What-is-an-image?">
<h2>What is an image?<a class="headerlink" href="#What-is-an-image?" title="Permalink to this headline">¶</a></h2>
<p>Instinctively, an image may resemble to a 2D plane composed of <strong>WIDTH * HEIGHT</strong> colored units arranged together in a particular manner.</p>
<p>In computing, a 2D image is generally a 3D object which is composed of <strong>WIDTH * HEIGHT</strong> units within each plane with respect the the third dimension, which is the <strong>DEPTH</strong> of the image, therefore giving <strong>WIDTH * HEIGHT * DEPTH = N_FEATURES</strong>.</p>
<p>Image depth is simply the number of channels which compose the image. You are certainly aware of RGB colors, for instance. In the RGB scheme, one color is written such as <code class="docutils literal notranslate"><span class="pre">rgb(int,</span> <span class="pre">int,</span> <span class="pre">int)</span></code> or <code class="docutils literal notranslate"><span class="pre">rgb(255,</span> <span class="pre">0,</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">rgb(0,</span> <span class="pre">255,</span> <span class="pre">0)</span></code> and <code class="docutils literal notranslate"><span class="pre">rgb(0,</span> <span class="pre">0,</span> <span class="pre">255)</span></code> for pure red, green and blue, respectively. One RGB image would therefore have a <strong>depth</strong> equal to 3, because three channels in there.</p>
<p>Note that following this scheme, an image is made of Numerical data, namely integer or <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p>
</div>
<div class="section" id="Why-preparing-a-dummy-dataset-with-…-features?">
<h2>Why preparing a dummy dataset with … features?<a class="headerlink" href="#Why-preparing-a-dummy-dataset-with-…-features?" title="Permalink to this headline">¶</a></h2>
<p>In addition to the general interest of dummy dataset explained in dummy dataset with boolean sample features.</p>
</div>
<div class="section" id="Prepare-a-set-of-image-sample-features-and-related-label">
<h2>Prepare a set of image sample features and related label<a class="headerlink" href="#Prepare-a-set-of-image-sample-features-and-related-label" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Imports">
<h3>Imports<a class="headerlink" href="#Imports" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># EpyNN/nnlive/dummy_image/prepare_dataset.ipynb</span>
<span class="c1"># Standard library imports</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># Related third party imports</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Seeding">
<h3>Seeding<a class="headerlink" href="#Seeding" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Generate-features">
<h3>Generate features<a class="headerlink" href="#Generate-features" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">features_image</span><span class="p">(</span><span class="n">WIDTH</span><span class="o">=</span><span class="mi">28</span><span class="p">,</span> <span class="n">HEIGHT</span><span class="o">=</span><span class="mi">28</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate dummy image features.</span>

<span class="sd">    :param WIDTH: Image width, defaults to 28.</span>
<span class="sd">    :type WIDTH: int</span>

<span class="sd">    :param HEIGHT: Image height, defaults to 28.</span>
<span class="sd">    :type HEIGHT: int</span>

<span class="sd">    :return: Random image features of size N_FEATURES.</span>
<span class="sd">    :rtype: :class:`numpy.ndarray`</span>

<span class="sd">    :return: Non-random image features of size N_FEATURES.</span>
<span class="sd">    :rtype: :class:`numpy.ndarray`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Number of channels is one for greyscale images</span>
    <span class="n">DEPTH</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># Number of features describing a sample</span>
    <span class="n">N_FEATURES</span> <span class="o">=</span> <span class="n">WIDTH</span> <span class="o">*</span> <span class="n">HEIGHT</span> <span class="o">*</span> <span class="n">DEPTH</span>

    <span class="c1"># Number of distinct tones in features</span>
    <span class="n">N_TONES</span> <span class="o">=</span> <span class="mi">16</span>

    <span class="c1"># Shades of grey</span>
    <span class="n">GSCALE</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_TONES</span><span class="p">)]</span>

    <span class="c1"># Random choice of shades for N_FEATURES iterations</span>
    <span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">GSCALE</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_FEATURES</span><span class="p">)]</span>

    <span class="n">mask_on_features</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N_FEATURES</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">N_FEATURES</span> <span class="o">//</span> <span class="mi">20</span> <span class="k">else</span> <span class="n">feature</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">]</span>

    <span class="c1"># Vectorization of features and masked features</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">HEIGHT</span><span class="p">,</span> <span class="n">WIDTH</span><span class="p">,</span> <span class="n">DEPTH</span><span class="p">)</span>
    <span class="n">mask_on_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mask_on_features</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="c1"># Random choice between random image or masked image</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="n">features</span><span class="p">,</span> <span class="n">mask_on_features</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">features</span><span class="p">,</span> <span class="n">mask_on_features</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">features</span><span class="p">,</span> <span class="n">mask_on_features</span> <span class="o">=</span> <span class="n">features_image</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="nnlive/dummy_image/../../_build/doctrees/nbsphinx/nnlive_dummy_image_prepare_dataset_12_0.png" src="nnlive/dummy_image/../../_build/doctrees/nbsphinx/nnlive_dummy_image_prepare_dataset_12_0.png" />
</div>
</div>
<p>This is the image features we retrieve for one sample.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">features</span> <span class="o">-</span> <span class="n">mask_on_features</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="nnlive/dummy_image/../../_build/doctrees/nbsphinx/nnlive_dummy_image_prepare_dataset_14_0.png" src="nnlive/dummy_image/../../_build/doctrees/nbsphinx/nnlive_dummy_image_prepare_dataset_14_0.png" />
</div>
</div>
<p>When subtracting <code class="docutils literal notranslate"><span class="pre">mask_on_features</span></code> from <code class="docutils literal notranslate"><span class="pre">features</span></code>, we observe that the image is not all black - is not all zeros -. This means that the random choice here has selected the non-random image, the one that has been alterated during the generation of image sample features.</p>
</div>
<div class="section" id="Generate-label">
<h3>Generate label<a class="headerlink" href="#Generate-label" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">label_features</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">mask_on_features</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prepare label associated with features.</span>

<span class="sd">    The dummy law is:</span>

<span class="sd">    Image is NOT random = positive</span>
<span class="sd">    Image is random = negative</span>

<span class="sd">    :param features: Random image features of size N_FEATURES</span>
<span class="sd">    :type features: :class:`numpy.ndarray`</span>

<span class="sd">    :param mask_on_features: Non-random image features of size N_FEATURES</span>
<span class="sd">    :type mask_on_features: :class:`numpy.ndarray`</span>

<span class="sd">    :return: Single-digit label with respect to features</span>
<span class="sd">    :rtype: int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Single-digit positive and negative labels</span>
    <span class="n">p_label</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">n_label</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Test if image is not random (+)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">features</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask_on_features</span><span class="p">):</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">p_label</span>

    <span class="c1"># Test if image is random (-)</span>
    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">features</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask_on_features</span><span class="p">):</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">n_label</span>

    <span class="k">return</span> <span class="n">label</span>
</pre></div>
</div>
</div>
<p>The code above is commented and self explaining.</p>
<p>Let’s check the function we made for a few iterations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">features</span><span class="p">,</span> <span class="n">mask_on_features</span> <span class="o">=</span> <span class="n">features_image</span><span class="p">()</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">label_features</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">mask_on_features</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask_on_features</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask_on_features</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1 5567 5567
0 5690 5690
0 5707 5707
1 5550 5550
0 5482 5482
</pre></div></div>
</div>
</div>
<div class="section" id="Prepare-dataset">
<h3>Prepare dataset<a class="headerlink" href="#Prepare-dataset" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">prepare_dataset</span><span class="p">(</span><span class="n">N_SAMPLES</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prepare a set of dummy time sample features and label.</span>

<span class="sd">    :param N_SAMPLES: Number of samples to generate, defaults to 100.</span>
<span class="sd">    :type N_SAMPLES: int</span>

<span class="sd">    :return: Set of sample features.</span>
<span class="sd">    :rtype: tuple[:class:`numpy.ndarray`]</span>

<span class="sd">    :return: Set of single-digit sample label.</span>
<span class="sd">    :rtype: tuple[int]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize X and Y datasets</span>
    <span class="n">X_features</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Y_label</span> <span class="o">=</span> <span class="p">[]</span>

   <span class="c1"># Iterate over N_SAMPLES</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_SAMPLES</span><span class="p">):</span>

        <span class="c1"># Compute random string features</span>
        <span class="n">features</span><span class="p">,</span> <span class="n">mask_on_features</span> <span class="o">=</span> <span class="n">features_image</span><span class="p">()</span>

        <span class="c1"># Retrieve label associated with features</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">label_features</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">mask_on_features</span><span class="p">)</span>

        <span class="c1"># Append sample features to X_features</span>
        <span class="n">X_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

        <span class="c1"># Append sample label to Y_label</span>
        <span class="n">Y_label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

    <span class="c1"># Prepare X-Y pairwise dataset</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">X_features</span><span class="p">,</span> <span class="n">Y_label</span><span class="p">))</span>

    <span class="c1"># Shuffle dataset</span>
    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

    <span class="c1"># Separate X-Y pairs</span>
    <span class="n">X_features</span><span class="p">,</span> <span class="n">Y_label</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">dataset</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_features</span><span class="p">,</span> <span class="n">Y_label</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="What-comes-next?">
<h2>What comes next?<a class="headerlink" href="#What-comes-next?" title="Permalink to this headline">¶</a></h2>
<p>The function <code class="docutils literal notranslate"><span class="pre">prepare_dataset()</span></code> applied to dummy time data is used in the following working examples:</p>
<p>XXX</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../captcha_mnist/prepare_dataset.html" class="btn btn-neutral float-right" title="MNIST Database" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../author_music/prepare_dataset.html" class="btn btn-neutral float-left" title="Music Authorship" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Florian Malard and Stéphanie Olivier-Van Stichelen.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>